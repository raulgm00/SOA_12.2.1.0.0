<?xml version="1.0" encoding="UTF-8"?>
<con:pipelineEntry xmlns:con="http://www.bea.com/wli/sb/pipeline/config" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:coreEntry>
        <con:description>Contiene el flujo para las operaciones de obtener listado de compañas y confirmación de campañas para el cliente, manejo de excepciones.</con:description>
        <con:binding type="SOAP" isSoap12="false" xsi:type="con:SoapBindingType">
            <con:wsdl ref="FuerzaDeVentas/Campanias/Credito/Resources/WSDLs/NMPCampaniasCreditoSvcWSDL"/>
            <con:binding>
                <con:name>campaniasCreditoBinding</con:name>
                <con:namespace>http://servicios.montedepiedad.com.mx/NMP/Services/Campanias/Credito</con:namespace>
            </con:binding>
        </con:binding>
        <oper:operations xmlns:oper="http://xmlns.oracle.com/servicebus/pipeline/operations">
            <oper:logging enabled="false" level="debug"/>
            <oper:monitoring enabled="true" level="service" aggregationInterval="10"/>
            <oper:reporting>false</oper:reporting>
        </oper:operations>
        <con:xqConfiguration>
            <con:snippetVersion>1.0</con:snippetVersion>
        </con:xqConfiguration>
    </con:coreEntry>
    <con:router errorHandler="_onErrorHandler-a1e030f.N46f09b50.11.153335d1f65.N7ffd">
        <con:pipeline name="_onErrorHandler-a1e030f.N46f09b50.18.153340a3aed.N8000" type="error">
            <con:stage name="StageManejadorErrorGetCampaniaFault">
                <con:context>
                    <con1:userNsDecl prefix="ns0" namespace="http://servicios.montedepiedad.com.mx/NMP/Schema/NMPStandardHeader" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                    <con1:userNsDecl prefix="con1" namespace="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                    <con1:userNsDecl prefix="nmp1" namespace="http://servicios.montedepiedad.com.mx/NMP/Schema/NMPCampaniasCreditoTypes" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                    <con1:varNsDecl prefix="nmp" namespace="http://servicios.montedepiedad.com.mx/NMP/Schema/NMPLlamada" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                </con:context>
                <con:actions>
                    <con1:replace varName="header" contents-only="true" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a1e030f.N46f09b50.11.153335d1f65.N7fff</con2:id>
                        <con1:location>
                            <con:xpathText xmlns:con="http://www.bea.com/wli/sb/stages/config">.</con:xpathText>
                        </con1:location>
                        <con1:expr>
                            <con:xqueryText xmlns:con="http://www.bea.com/wli/sb/stages/config"><![CDATA[fn-bea:inlinedXML(concat(' <ns0:headerMessageResponse xmlns:ns0="http://servicios.montedepiedad.com.mx/NMP/Schema/NMPStandardHeader">
         <ns0:usuario>',$header//ns0:usuario/text(),'</ns0:usuario>
         <ns0:idConsumidor>',$header//ns0:idConsumidor/text(),'</ns0:idConsumidor>
         <ns0:idDestino>',$header//ns0:idDestino/text(),'</ns0:idDestino>
         <ns0:codigoRespuesta>1</ns0:codigoRespuesta>
         <ns0:descripcionRespuesta>Error</ns0:descripcionRespuesta>
      </ns0:headerMessageResponse>
'))]]></con:xqueryText>
                        </con1:expr>
                    </con1:replace>
                    <con1:replace varName="body" contents-only="true" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a1e030f.N46f09b50.16.1533361fa34.N7ffd</con2:id>
                        <con1:location>
                            <con:xpathText xmlns:con="http://www.bea.com/wli/sb/stages/config">.</con:xpathText>
                        </con1:location>
                        <con1:expr>
                            <con:xsltTransform xmlns:con="http://www.bea.com/wli/sb/stages/config">
                                <con:resource ref="FuerzaDeVentas/Campanias/Credito/Resources/Transformations/TransformCampaniaFault"/>
                                <con:input>$fault</con:input>
                                <con:param name="detailFault">
                                    <con:path>$fault/ctx:details/con1:ReceivedFaultDetail/con1:faultstring/text()</con:path>
                                </con:param>
                                <con:param name="codigoFault">
                                    <con:path>$fault/ctx:details/con1:ReceivedFaultDetail/con1:faultcode/text()</con:path>
                                </con:param>
                            </con:xsltTransform>
                        </con1:expr>
                    </con1:replace>
                    <con1:report xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a1e030f.N46f09b50.18.153340a3aed.N7fff</con2:id>
                        <con1:expr>
                            <con:xqueryText xmlns:con="http://www.bea.com/wli/sb/stages/config">fn:substring(fn-bea:serialize($body), 0, 1000)</con:xqueryText>
                        </con1:expr>
                        <con1:labels>
                            <con1:key>errorgetCampania</con1:key>
                            <con1:varName>body_temp</con1:varName>
                            <con1:value>
                                <con:xpathText xmlns:con="http://www.bea.com/wli/sb/stages/config">./nmp:getCampaniasClienteRequest/nmp1:CredencialNMP/text()</con:xpathText>
                            </con1:value>
                        </con1:labels>
                    </con1:report>
                    <con1:reply isError="true" xmlns:con1="http://www.bea.com/wli/sb/stages/config">
                        <con1:id>_ActionId-a1e030f.N46f09b50.18.153340a3aed.N7ffe</con1:id>
                    </con1:reply>
                </con:actions>
            </con:stage>
        </con:pipeline>
        <con:pipeline name="_onErrorHandler-a1e030f.N46f09b50.11.153335d1f65.N7ffd" type="error">
            <con:stage name="campaniasCreditoFault">
                <con:context>
                    <con1:userNsDecl prefix="ns0" namespace="http://servicios.montedepiedad.com.mx/NMP/Schema/NMPStandardHeader" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                    <con1:userNsDecl prefix="con1" namespace="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                    <con1:userNsDecl prefix="nmp1" namespace="http://servicios.montedepiedad.com.mx/NMP/Schema/NMPCampaniasCreditoTypes" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                    <con1:varNsDecl prefix="nmp" namespace="http://servicios.montedepiedad.com.mx/NMP/Schema/NMPLlamada" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                </con:context>
                <con:actions>
                    <con1:ifThenElse xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a1e030f.N46f09b50.10.153335670bb.N7ffd</con2:id>
                        <con1:case>
                            <con1:condition>
                                <con:xqueryText xmlns:con="http://www.bea.com/wli/sb/stages/config">fn:not($body/soap-env:Fault)</con:xqueryText>
                            </con1:condition>
                            <con1:actions>
                                <con1:replace varName="header" contents-only="true">
                                    <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a1e030f.N46f09b50.f.15333512e1a.N7ffd</con2:id>
                                    <con1:location>
                                        <con:xpathText xmlns:con="http://www.bea.com/wli/sb/stages/config">.</con:xpathText>
                                    </con1:location>
                                    <con1:expr>
                                        <con:xqueryText xmlns:con="http://www.bea.com/wli/sb/stages/config"><![CDATA[fn-bea:inlinedXML(concat(' <ns0:headerMessageResponse xmlns:ns0="http://servicios.montedepiedad.com.mx/NMP/Schema/NMPStandardHeader">
         <ns0:usuario>',$header//ns0:usuario/text(),'</ns0:usuario>
         <ns0:idConsumidor>',$header//ns0:idConsumidor/text(),'</ns0:idConsumidor>
         <ns0:idDestino>',$header//ns0:idDestino/text(),'</ns0:idDestino>
         <ns0:codigoRespuesta>1</ns0:codigoRespuesta>
         <ns0:descripcionRespuesta>Error</ns0:descripcionRespuesta>
      </ns0:headerMessageResponse>
'))]]></con:xqueryText>
                                    </con1:expr>
                                </con1:replace>
                                <con1:replace varName="body" contents-only="true">
                                    <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a1e030f.N46f09b50.17.15333a56d8d.N7ffe</con2:id>
                                    <con1:location>
                                        <con:xpathText xmlns:con="http://www.bea.com/wli/sb/stages/config">.</con:xpathText>
                                    </con1:location>
                                    <con1:expr>
                                        <con:xsltTransform xmlns:con="http://www.bea.com/wli/sb/stages/config">
                                            <con:resource ref="FuerzaDeVentas/Campanias/Credito/Resources/Transformations/TransformCampaniaFault"/>
                                            <con:input>$fault</con:input>
                                            <con:param name="detailFault">
                                                <con:path>$fault/ctx:details/con1:ReceivedFaultDetail/con1:faultstring/text()</con:path>
                                            </con:param>
                                            <con:param name="codigoFault">
                                                <con:path>$fault/ctx:details/con1:ReceivedFaultDetail/con1:faultcode/text()</con:path>
                                            </con:param>
                                        </con:xsltTransform>
                                    </con1:expr>
                                </con1:replace>
                                <con2:report xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                                    <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-a1e030f.N46f09b50.17.15333a56d8d.N7ffd</con3:id>
                                    <con2:expr>
                                        <con:xqueryText xmlns:con="http://www.bea.com/wli/sb/stages/config">fn:substring(fn-bea:serialize($body), 0, 1000)</con:xqueryText>
                                    </con2:expr>
                                    <con2:labels>
                                        <con2:key>errorCampaniasCredito</con2:key>
                                        <con2:varName>body_temp</con2:varName>
                                        <con2:value>
                                            <con:xpathText xmlns:con="http://www.bea.com/wli/sb/stages/config">./nmp:getCampaniasClienteRequest/nmp1:CredencialNMP/text()</con:xpathText>
                                        </con2:value>
                                    </con2:labels>
                                </con2:report>
                                <con2:reply isError="true" xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                                    <con2:id>_ActionId-a1e030f.N46f09b50.11.153335d1f65.N7ffc</con2:id>
                                </con2:reply>
                            </con1:actions>
                        </con1:case>
                    </con1:ifThenElse>
                </con:actions>
            </con:stage>
        </con:pipeline>
        <con:pipeline name="PipelinePairNodeConfirmaCompania_response" type="response">
            <con:stage name="StageConfirmaCompaniaRes">
                <con:comment/>
                <con:context>
                    <con1:userNsDecl prefix="ns0" namespace="http://servicios.montedepiedad.com.mx/NMP/Schema/NMPStandardHeader" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                    <con1:userNsDecl prefix="nmp1" namespace="http://servicios.montedepiedad.com.mx/NMP/Schema/NMPCampaniasCreditoTypes" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                    <con1:userNsDecl prefix="nmp2" namespace="http://servicios.montedepiedad.com.mx/NMP/Schema/NMPCampaniasCreditoTypes" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                    <con1:userNsDecl prefix="con1" namespace="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                    <con1:varNsDecl prefix="nmp" namespace="http://servicios.montedepiedad.com.mx/NMP/Schema/NMPLlamada" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                </con:context>
                <con:actions>
                    <con1:ifThenElse xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a1e030f.N46f09b50.18.153340a3aed.N7ffb</con2:id>
                        <con1:case>
                            <con1:condition>
                                <con:xqueryText xmlns:con="http://www.bea.com/wli/sb/stages/config">$confirmaCampaniaRes//*:Codigo='0'</con:xqueryText>
                            </con1:condition>
                            <con1:actions>
                                <con1:replace varName="header" contents-only="true">
                                    <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a1e030f.N46f09b50.18.153340a3aed.N7ffa</con2:id>
                                    <con1:location>
                                        <con:xpathText xmlns:con="http://www.bea.com/wli/sb/stages/config">.</con:xpathText>
                                    </con1:location>
                                    <con1:expr>
                                        <con:xqueryText xmlns:con="http://www.bea.com/wli/sb/stages/config"><![CDATA[fn-bea:inlinedXML(concat(' <ns0:headerMessageResponse xmlns:ns0="http://servicios.montedepiedad.com.mx/NMP/Schema/NMPStandardHeader">
         <ns0:usuario>',$header//ns0:usuario/text(),'</ns0:usuario>
         <ns0:idConsumidor>',$header//ns0:idConsumidor/text(),'</ns0:idConsumidor>
         <ns0:idDestino>',$header//ns0:idDestino/text(),'</ns0:idDestino>
         <ns0:codigoRespuesta>0</ns0:codigoRespuesta>
         <ns0:descripcionRespuesta>Success</ns0:descripcionRespuesta>
      </ns0:headerMessageResponse>
'))]]></con:xqueryText>
                                    </con1:expr>
                                </con1:replace>
                                <con1:replace varName="body" contents-only="true">
                                    <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a1e030f.N46f09b50.16.1533361fa34.N7ffb</con2:id>
                                    <con1:location>
                                        <con:xpathText xmlns:con="http://www.bea.com/wli/sb/stages/config">.</con:xpathText>
                                    </con1:location>
                                    <con1:expr>
                                        <con:xqueryTransform xmlns:con="http://www.bea.com/wli/sb/stages/config">
                                            <con:resource ref="FuerzaDeVentas/Campanias/Credito/Resources/Transformations/TransformConfirmaCompania"/>
                                            <con:param name="confirmaCampaniaRes">
                                                <con:path>$confirmaCampaniaRes</con:path>
                                            </con:param>
                                        </con:xqueryTransform>
                                    </con1:expr>
                                </con1:replace>
                                <con1:report xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
                                    <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a1e030f.N46f09b50.17.15333a56d8d.N7ffa</con2:id>
                                    <con1:expr>
                                        <con:xqueryText xmlns:con="http://www.bea.com/wli/sb/stages/config">fn:substring(fn-bea:serialize($body), 0, 1000)</con:xqueryText>
                                    </con1:expr>
                                    <con1:labels>
                                        <con1:key>confirmaCampaniaRes</con1:key>
                                        <con1:varName>body_temp</con1:varName>
                                        <con1:value>
                                            <con:xpathText xmlns:con="http://www.bea.com/wli/sb/stages/config">./nmp:confirmarCampaniaClienteRequest/nmp1:idLlamada/text()</con:xpathText>
                                        </con1:value>
                                    </con1:labels>
                                </con1:report>
                            </con1:actions>
                        </con1:case>
                        <con1:default>
                            <con:replace varName="header" contents-only="true" xmlns:con="http://www.bea.com/wli/sb/stages/transform/config">
                                <con1:id xmlns:con1="http://www.bea.com/wli/sb/stages/config">_ActionId-a1e030f.N46f09b50.18.153340a3aed.N7ff7</con1:id>
                                <con:location>
                                    <con:xpathText xmlns:con="http://www.bea.com/wli/sb/stages/config">.</con:xpathText>
                                </con:location>
                                <con:expr>
                                    <con:xqueryText xmlns:con="http://www.bea.com/wli/sb/stages/config"><![CDATA[fn-bea:inlinedXML(concat(' <ns0:headerMessageResponse xmlns:ns0="http://servicios.montedepiedad.com.mx/NMP/Schema/NMPStandardHeader">
         <ns0:usuario>',$header//ns0:usuario/text(),'</ns0:usuario>
         <ns0:idConsumidor>',$header//ns0:idConsumidor/text(),'</ns0:idConsumidor>
         <ns0:idDestino>',$header//ns0:idDestino/text(),'</ns0:idDestino>
         <ns0:codigoRespuesta>1</ns0:codigoRespuesta>
         <ns0:descripcionRespuesta>Error</ns0:descripcionRespuesta>
      </ns0:headerMessageResponse>
'))]]></con:xqueryText>
                                </con:expr>
                            </con:replace>
                            <con:replace varName="body" contents-only="true" xmlns:con="http://www.bea.com/wli/sb/stages/transform/config">
                                <con1:id xmlns:con1="http://www.bea.com/wli/sb/stages/config">_ActionId-a1e030f.N46f09b50.18.153340a3aed.N7ff6</con1:id>
                                <con:location>
                                    <con:xpathText xmlns:con="http://www.bea.com/wli/sb/stages/config">.</con:xpathText>
                                </con:location>
                                <con:expr>
                                    <con:xsltTransform xmlns:con="http://www.bea.com/wli/sb/stages/config">
                                        <con:resource ref="FuerzaDeVentas/Campanias/Credito/Resources/Transformations/TransformCampaniaFault"/>
                                        <con:input>$confirmaCampaniaRes</con:input>
                                        <con:param name="detailFault">
                                            <con:path>$confirmaCampaniaRes//*:Mensaje/text()</con:path>
                                        </con:param>
                                        <con:param name="codigoFault">
                                            <con:path>'confirmaCampaniaFaultMessage'</con:path>
                                        </con:param>
                                    </con:xsltTransform>
                                </con:expr>
                            </con:replace>
                            <con:report xmlns:con="http://www.bea.com/wli/sb/stages/logging/config">
                                <con1:id xmlns:con1="http://www.bea.com/wli/sb/stages/config">_ActionId-a1e030f.N46f09b50.11.153335d1f65.N7ffa</con1:id>
                                <con:expr>
                                    <con:xqueryText xmlns:con="http://www.bea.com/wli/sb/stages/config">fn:substring(fn-bea:serialize($body), 0, 1000)</con:xqueryText>
                                </con:expr>
                                <con:labels>
                                    <con:key>errorgetCampania</con:key>
                                    <con:varName>body_temp</con:varName>
                                    <con:value>
                                        <con:xpathText xmlns:con="http://www.bea.com/wli/sb/stages/config">./nmp:getCampaniasClienteRequest/nmp1:CredencialNMP/text()</con:xpathText>
                                    </con:value>
                                </con:labels>
                            </con:report>
                            <con2:reply isError="true" xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                                <con2:id>_ActionId-a1e030f.N46f09b50.11.153335d1f65.N7ff9</con2:id>
                            </con2:reply>
                        </con1:default>
                    </con1:ifThenElse>
                </con:actions>
            </con:stage>
        </con:pipeline>
        <con:pipeline name="_onErrorHandler-a1e030f.N46f09b50.12.153335d5184.N7ffa" type="error">
            <con:stage name="StageManejadorErrorConfirmaCampaniaFault">
                <con:context>
                    <con1:userNsDecl prefix="ns0" namespace="http://servicios.montedepiedad.com.mx/NMP/Schema/NMPStandardHeader" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                    <con1:userNsDecl prefix="con1" namespace="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                    <con1:userNsDecl prefix="nmp1" namespace="http://servicios.montedepiedad.com.mx/NMP/Schema/NMPCampaniasCreditoTypes" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                    <con1:varNsDecl prefix="nmp" namespace="http://servicios.montedepiedad.com.mx/NMP/Schema/NMPLlamada" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                </con:context>
                <con:actions>
                    <con1:replace varName="header" contents-only="true" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a1e030f.N46f09b50.15.15333607b7c.N7ffc</con2:id>
                        <con1:location>
                            <con:xpathText xmlns:con="http://www.bea.com/wli/sb/stages/config">.</con:xpathText>
                        </con1:location>
                        <con1:expr>
                            <con:xqueryText xmlns:con="http://www.bea.com/wli/sb/stages/config"><![CDATA[fn-bea:inlinedXML(concat(' <ns0:headerMessageResponse xmlns:ns0="http://servicios.montedepiedad.com.mx/NMP/Schema/NMPStandardHeader">
         <ns0:usuario>',$header//ns0:usuario/text(),'</ns0:usuario>
         <ns0:idConsumidor>',$header//ns0:idConsumidor/text(),'</ns0:idConsumidor>
         <ns0:idDestino>',$header//ns0:idDestino/text(),'</ns0:idDestino>
         <ns0:codigoRespuesta>1</ns0:codigoRespuesta>
         <ns0:descripcionRespuesta>Error</ns0:descripcionRespuesta>
      </ns0:headerMessageResponse>
'))]]></con:xqueryText>
                        </con1:expr>
                    </con1:replace>
                    <con1:replace varName="body" contents-only="true" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a1e030f.N46f09b50.16.1533361fa34.N7ffc</con2:id>
                        <con1:location>
                            <con:xpathText xmlns:con="http://www.bea.com/wli/sb/stages/config">.</con:xpathText>
                        </con1:location>
                        <con1:expr>
                            <con:xsltTransform xmlns:con="http://www.bea.com/wli/sb/stages/config">
                                <con:resource ref="FuerzaDeVentas/Campanias/Credito/Resources/Transformations/TransformCampaniaFault"/>
                                <con:input>$fault</con:input>
                                <con:param name="detailFault">
                                    <con:path>$fault/ctx:details/con1:ReceivedFaultDetail/con1:faultstring/text()</con:path>
                                </con:param>
                                <con:param name="codigoFault">
                                    <con:path>$fault/ctx:details/con1:ReceivedFaultDetail/con1:faultcode/text()</con:path>
                                </con:param>
                            </con:xsltTransform>
                        </con1:expr>
                    </con1:replace>
                    <con1:report xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a1e030f.N46f09b50.15.15333607b7c.N7ffb</con2:id>
                        <con1:expr>
                            <con:xqueryText xmlns:con="http://www.bea.com/wli/sb/stages/config">fn:substring(fn-bea:serialize($body), 0, 1000)</con:xqueryText>
                        </con1:expr>
                        <con1:labels>
                            <con1:key>errorConfirmaCampania</con1:key>
                            <con1:varName>body_temp</con1:varName>
                            <con1:value>
                                <con:xpathText xmlns:con="http://www.bea.com/wli/sb/stages/config">./nmp:confirmarCampaniaClienteRequest/nmp1:idLlamada/text()</con:xpathText>
                            </con1:value>
                        </con1:labels>
                    </con1:report>
                    <con1:reply isError="true" xmlns:con1="http://www.bea.com/wli/sb/stages/config">
                        <con1:id>_ActionId-a1e030f.N46f09b50.15.15333607b7c.N7ffa</con1:id>
                    </con1:reply>
                </con:actions>
            </con:stage>
        </con:pipeline>
        <con:pipeline name="PipelinePairNodeGetCampania_response" type="response">
            <con:stage name="StageGetCampaniaRes">
                <con:comment/>
                <con:context>
                    <con1:userNsDecl prefix="ns0" namespace="http://servicios.montedepiedad.com.mx/NMP/Schema/NMPStandardHeader" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                    <con1:userNsDecl prefix="nmp2" namespace="http://servicios.montedepiedad.com.mx/NMP/Schema/NMPCampaniasCreditoTypes" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                    <con1:userNsDecl prefix="nmp1" namespace="http://servicios.montedepiedad.com.mx/NMP/Schema/NMPLlamada" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                    <con1:varNsDecl prefix="nmp" namespace="http://servicios.montedepiedad.com.mx/NMP/Schema/NMPLlamada" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                </con:context>
                <con:actions>
                    <con1:ifThenElse xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a1e030f.N46f09b50.11.153335d1f65.N7ffe</con2:id>
                        <con1:case>
                            <con1:condition>
                                <con:xqueryText xmlns:con="http://www.bea.com/wli/sb/stages/config">fn:compare($getCampaniasRes//*:Mensaje/text(),"Registros encontrados")=0</con:xqueryText>
                            </con1:condition>
                            <con1:actions>
                                <con1:replace varName="header" contents-only="true">
                                    <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a1e030f.N46f09b50.f.15333512e1a.N7ffe</con2:id>
                                    <con1:location>
                                        <con:xpathText xmlns:con="http://www.bea.com/wli/sb/stages/config">.</con:xpathText>
                                    </con1:location>
                                    <con1:expr>
                                        <con:xqueryText xmlns:con="http://www.bea.com/wli/sb/stages/config"><![CDATA[fn-bea:inlinedXML(concat(' <ns0:headerMessageResponse xmlns:ns0="http://servicios.montedepiedad.com.mx/NMP/Schema/NMPStandardHeader">
         <ns0:usuario>',$header//ns0:usuario/text(),'</ns0:usuario>
         <ns0:idConsumidor>',$header//ns0:idConsumidor/text(),'</ns0:idConsumidor>
         <ns0:idDestino>',$header//ns0:idDestino/text(),'</ns0:idDestino>
         <ns0:codigoRespuesta>0</ns0:codigoRespuesta>
         <ns0:descripcionRespuesta>Success</ns0:descripcionRespuesta>
      </ns0:headerMessageResponse>
'))]]></con:xqueryText>
                                    </con1:expr>
                                </con1:replace>
                                <con1:replace varName="body" contents-only="true">
                                    <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a1e030f.N46f09b50.17.15333a56d8d.N7fff</con2:id>
                                    <con1:location>
                                        <con:xpathText xmlns:con="http://www.bea.com/wli/sb/stages/config">.</con:xpathText>
                                    </con1:location>
                                    <con1:expr>
                                        <con:xqueryTransform xmlns:con="http://www.bea.com/wli/sb/stages/config">
                                            <con:resource ref="FuerzaDeVentas/Campanias/Credito/Resources/Transformations/TranformGetCompaniasResponse"/>
                                            <con:param name="getCampaniasRes">
                                                <con:path>$getCampaniasRes</con:path>
                                            </con:param>
                                        </con:xqueryTransform>
                                    </con1:expr>
                                </con1:replace>
                                <con2:report xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                                    <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-a1e030f.N46f09b50.14.153335e1c77.N7ffc</con3:id>
                                    <con2:expr>
                                        <con:xqueryText xmlns:con="http://www.bea.com/wli/sb/stages/config">fn:substring(fn-bea:serialize($body), 0, 1000)</con:xqueryText>
                                    </con2:expr>
                                    <con2:labels>
                                        <con2:key>getCompaniaRes</con2:key>
                                        <con2:varName>body_temp</con2:varName>
                                        <con2:value>
                                            <con:xpathText xmlns:con="http://www.bea.com/wli/sb/stages/config">./nmp:getCampaniasClienteRequest/nmp2:CredencialNMP/text()</con:xpathText>
                                        </con2:value>
                                    </con2:labels>
                                </con2:report>
                            </con1:actions>
                        </con1:case>
                        <con1:default>
                            <con:replace varName="header" contents-only="true" xmlns:con="http://www.bea.com/wli/sb/stages/transform/config">
                                <con1:id xmlns:con1="http://www.bea.com/wli/sb/stages/config">_ActionId-a1e030f.N46f09b50.12.153335d5184.N7ffc</con1:id>
                                <con:location>
                                    <con:xpathText xmlns:con="http://www.bea.com/wli/sb/stages/config">.</con:xpathText>
                                </con:location>
                                <con:expr>
                                    <con:xqueryText xmlns:con="http://www.bea.com/wli/sb/stages/config"><![CDATA[fn-bea:inlinedXML(concat(' <ns0:headerMessageResponse xmlns:ns0="http://servicios.montedepiedad.com.mx/NMP/Schema/NMPStandardHeader">
         <ns0:usuario>',$header//ns0:usuario/text(),'</ns0:usuario>
         <ns0:idConsumidor>',$header//ns0:idConsumidor/text(),'</ns0:idConsumidor>
         <ns0:idDestino>',$header//ns0:idDestino/text(),'</ns0:idDestino>
         <ns0:codigoRespuesta>1</ns0:codigoRespuesta>
         <ns0:descripcionRespuesta>Error</ns0:descripcionRespuesta>
      </ns0:headerMessageResponse>
'))]]></con:xqueryText>
                                </con:expr>
                            </con:replace>
                            <con:replace varName="body" contents-only="true" xmlns:con="http://www.bea.com/wli/sb/stages/transform/config">
                                <con1:id xmlns:con1="http://www.bea.com/wli/sb/stages/config">_ActionId-a1e030f.N46f09b50.12.153335d5184.N7ffb</con1:id>
                                <con:location>
                                    <con:xpathText xmlns:con="http://www.bea.com/wli/sb/stages/config">.</con:xpathText>
                                </con:location>
                                <con:expr>
                                    <con:xsltTransform xmlns:con="http://www.bea.com/wli/sb/stages/config">
                                        <con:resource ref="FuerzaDeVentas/Campanias/Credito/Resources/Transformations/TransformCampaniaFault"/>
                                        <con:input>$getCampaniasRes</con:input>
                                        <con:param name="detailFault">
                                            <con:path>$getCampaniasRes//*:Mensaje/text()</con:path>
                                        </con:param>
                                        <con:param name="codigoFault">
                                            <con:path>'campaniaClienteFaultMessage'</con:path>
                                        </con:param>
                                    </con:xsltTransform>
                                </con:expr>
                            </con:replace>
                            <con:report xmlns:con="http://www.bea.com/wli/sb/stages/logging/config">
                                <con1:id xmlns:con1="http://www.bea.com/wli/sb/stages/config">_ActionId-a1e030f.N46f09b50.10.153335670bb.N7ffe</con1:id>
                                <con:expr>
                                    <con:xqueryText xmlns:con="http://www.bea.com/wli/sb/stages/config">fn:substring(fn-bea:serialize($body), 0, 1000)</con:xqueryText>
                                </con:expr>
                                <con:labels>
                                    <con:key>errorgetCampania</con:key>
                                    <con:varName>body_temp</con:varName>
                                    <con:value>
                                        <con:xpathText xmlns:con="http://www.bea.com/wli/sb/stages/config">./nmp:getCampaniasClienteRequest/nmp1:CredencialNMP/text()</con:xpathText>
                                    </con:value>
                                </con:labels>
                            </con:report>
                        </con1:default>
                    </con1:ifThenElse>
                </con:actions>
            </con:stage>
        </con:pipeline>
        <con:pipeline name="PipelinePairNodeGetCampania_request" type="request">
            <con:stage name="StageGetCampaniaReq" errorHandler="_onErrorHandler-a1e030f.N46f09b50.18.153340a3aed.N8000">
                <con:comment/>
                <con:context>
                    <con1:userNsDecl prefix="cit" namespace="http://servicios.montedepiedad.com.mx/NMP/Schema/CitaType" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                    <con1:userNsDecl prefix="tem" namespace="http://tempuri.org/" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                    <con1:userNsDecl prefix="nmp" namespace="http://servicios.montedepiedad.com.mx/NMP/Schema/NMPCampaniasCredito" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                    <con1:userNsDecl prefix="nmp2" namespace="http://servicios.montedepiedad.com.mx/NMP/Schema/NMPCampaniasCreditoTypes" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                    <con1:varNsDecl prefix="nmp1" namespace="http://servicios.montedepiedad.com.mx/NMP/Schema/NMPLlamada" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                </con:context>
                <con:actions>
                    <con1:assign varName="getCampaniasReq" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a1e030f.N46f09b50.f.15333512e1a.N7fff</con2:id>
                        <con1:expr>
                            <con:xqueryText xmlns:con="http://www.bea.com/wli/sb/stages/config">fn-bea:inlinedXML(fn:concat("&lt;tem:ConsultaListaCampañasCliente xmlns:tem='http://tempuri.org/'>
        &lt;tem:CredencialNMP>", $body/nmp:getCampaniasClienteRequest/nmp2:CredencialNMP/text(),"&lt;/tem:CredencialNMP>
    &lt;/tem:ConsultaListaCampañasCliente>"))</con:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:report xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a1e030f.N46f09b50.16.1533361fa34.N7ffe</con2:id>
                        <con1:expr>
                            <con:xqueryText xmlns:con="http://www.bea.com/wli/sb/stages/config">fn:substring(fn-bea:serialize($body), 0, 1000)</con:xqueryText>
                        </con1:expr>
                        <con1:labels>
                            <con1:key>getCompania</con1:key>
                            <con1:varName>body</con1:varName>
                            <con1:value>
                                <con:xpathText xmlns:con="http://www.bea.com/wli/sb/stages/config">./nmp:getCampaniasClienteRequest/nmp1:CredencialNMP/text()</con:xpathText>
                            </con1:value>
                        </con1:labels>
                    </con1:report>
                    <con1:assign varName="body_temp" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a1e030f.N46f09b50.14.153335e1c77.N7ffd</con2:id>
                        <con1:expr>
                            <con:xqueryText xmlns:con="http://www.bea.com/wli/sb/stages/config">$body</con:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:wsCallout xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a1e030f.N46f09b50.12.153335d5184.N7ffd</con2:id>
                        <con1:service ref="GestionCatalogos/Sepomex/Business Services/CRMServicioCatalogosBS" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con1:operation>ConsultaListaCampañasCliente</con1:operation>
                        <con1:request>
                            <con1:body wrapped="false">getCampaniasReq</con1:body>
                            <con1:header/>
                        </con1:request>
                        <con1:response>
                            <con1:body wrapped="false">getCampaniasRes</con1:body>
                            <con1:header/>
                        </con1:response>
                        <con1:requestTransform/>
                        <con1:responseTransform/>
                    </con1:wsCallout>
                </con:actions>
            </con:stage>
        </con:pipeline>
        <con:pipeline name="PipelinePairNodeConfirmaCompania_request" type="request">
            <con:stage name="StageConfirmaCompaniaReq" errorHandler="_onErrorHandler-a1e030f.N46f09b50.12.153335d5184.N7ffa">
                <con:comment/>
                <con:context>
                    <con1:userNsDecl prefix="nmp1" namespace="http://servicios.montedepiedad.com.mx/NMP/Schema/NMPCampaniasCredito" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                    <con1:userNsDecl prefix="nmp0" namespace="http://servicios.montedepiedad.com.mx/NMP/Schema/NMPCampaniasCreditoTypes" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                    <con1:varNsDecl prefix="nmp" namespace="http://servicios.montedepiedad.com.mx/NMP/Schema/NMPLlamada" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                    <con1:varNsDecl prefix="nmp2" namespace="http://servicios.montedepiedad.com.mx/NMP/Schema/NMPLlamada" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                </con:context>
                <con:actions>
                    <con1:assign varName="confirmaCampaniaReq" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a1e030f.N46f09b50.10.153335670bb.N7ffc</con2:id>
                        <con1:expr>
                            <con:xqueryText xmlns:con="http://www.bea.com/wli/sb/stages/config"><![CDATA[fn-bea:inlinedXML(fn:concat("<tem:ConfirmaInteresCampaña xmlns:tem='http://tempuri.org/'>
	<tem:requestConfirma xmlns:nmp='http://schemas.datacontract.org/2004/07/NMP.MRT.BusinessTypes'>
		<nmp:IdLlamada>", $body/nmp1:confirmarCampaniaClienteRequest/nmp0:idLlamada/text(), "</nmp:IdLlamada>",
		if($body/nmp1:confirmarCampaniaClienteRequest/nmp0:isInteresado/text() = "true")
		then "<nmp:RespuestaCamp>1</nmp:RespuestaCamp>"
                else "<nmp:RespuestaCamp>0</nmp:RespuestaCamp>",
       "</tem:requestConfirma>
</tem:ConfirmaInteresCampaña>"))]]></con:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:report xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a1e030f.N46f09b50.17.15333a56d8d.N7ffc</con2:id>
                        <con1:expr>
                            <con:xqueryText xmlns:con="http://www.bea.com/wli/sb/stages/config">fn:substring(fn-bea:serialize($body), 0, 1000)</con:xqueryText>
                        </con1:expr>
                        <con1:labels>
                            <con1:key>confirmaCampaniaReq</con1:key>
                            <con1:varName>body</con1:varName>
                            <con1:value>
                                <con:xpathText xmlns:con="http://www.bea.com/wli/sb/stages/config">./nmp:confirmarCampaniaClienteRequest/nmp1:idLlamada/text()</con:xpathText>
                            </con1:value>
                        </con1:labels>
                    </con1:report>
                    <con1:assign varName="body_temp" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a1e030f.N46f09b50.15.15333607b7c.N7ffd</con2:id>
                        <con1:expr>
                            <con:xqueryText xmlns:con="http://www.bea.com/wli/sb/stages/config">$body</con:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:wsCallout xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a1e030f.N46f09b50.17.15333a56d8d.N7ffb</con2:id>
                        <con1:service ref="FuerzaDeVentas/GestionOrdenesTrabajo/Proxy Services/CRMServicioOrdenesPXY" xsi:type="ref:ProxyRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con1:operation>ConfirmaInteresCampaña</con1:operation>
                        <con1:request>
                            <con1:body wrapped="false">confirmaCampaniaReq</con1:body>
                            <con1:header>header</con1:header>
                        </con1:request>
                        <con1:response>
                            <con1:body wrapped="false">confirmaCampaniaRes</con1:body>
                        </con1:response>
                        <con1:requestTransform/>
                        <con1:responseTransform/>
                    </con1:wsCallout>
                </con:actions>
            </con:stage>
        </con:pipeline>
        <con:flow>
            <con:branch-node type="operation" name="BranchNodeOperations">
                <con:comment/>
                <con:branch-table>
                    <con:branch name="getCampaniasCliente">
                        <con:operator>equals</con:operator>
                        <con:value>getCampaniasCliente</con:value>
                        <con:flow>
                            <con:pipeline-node name="PipelinePairNodeGetCampania">
                                <con:comment/>
                                <con:request>PipelinePairNodeGetCampania_request</con:request>
                                <con:response>PipelinePairNodeGetCampania_response</con:response>
                            </con:pipeline-node>
                        </con:flow>
                    </con:branch>
                    <con:branch name="confirmarCampaniaCliente">
                        <con:operator>equals</con:operator>
                        <con:value>confirmarCampaniaCliente</con:value>
                        <con:flow>
                            <con:pipeline-node name="PipelinePairNodeConfirmaCompania">
                                <con:comment/>
                                <con:request>PipelinePairNodeConfirmaCompania_request</con:request>
                                <con:response>PipelinePairNodeConfirmaCompania_response</con:response>
                            </con:pipeline-node>
                        </con:flow>
                    </con:branch>
                    <con:default-branch/>
                </con:branch-table>
            </con:branch-node>
        </con:flow>
    </con:router>
    <aler:alertRules xsi:nil="true" xmlns:aler="http://xmlns.oracle.com/servicebus/monitoring/alert"/>
</con:pipelineEntry>