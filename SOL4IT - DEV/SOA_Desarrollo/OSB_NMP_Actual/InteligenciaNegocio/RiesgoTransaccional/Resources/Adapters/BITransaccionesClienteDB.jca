<adapter-config name="BITransanccionesDb" adapter="db" wsdlLocation="../WSDLs/BITransaccionesClienteDBWSDL.wsdl" xmlns="http://platform.integration.oracle/blocks/adapter/fw/metadata">
  <connection-factory UIConnectionName="ConnectionBI_db" location="eis/DB/userbi"/>
  <endpoint-interaction portType="BITransaccionesPT" operation="getHistoricoByCliente">
    <interaction-spec className="oracle.tip.adapter.db.DBPureSQLInteractionSpec">
      <property name="SqlString" value="SELECT               MOVIMIENTO.PARTIDA_MERCANCIA_ID PARTIDA_MERCANCIA_ID,                MOVIMIENTO.DET_MOVIMIENTO_ID DET_MOVIMIENTO_ID,               PARTIDA.FOLIO FOLIO,         TOPERACION.ABREVIATURA ABREVIATURA,               TOPERACION.DESC_IMPORTE DESC_IMPORTE,        MOVIMIENTO.NUMERO_SUCURSAL NUMERO_SUCURSAL,                MOVIMIENTO.TIMESTAMP_OPERACION TIMESTAMP_OPERACION,        PREND.PRESTAMO PRESTAMO,        IMPORTES.MEDIO_PAGO_COBRO_ID MEDIO_PAGO_COBRO_ID  FROM NMPODSMDS.XXNMP_TX_DET_MOV_PRE_COM_DS MOVIMIENTO,             NMPODSMDS.XXNMP_TX_IMPORTES_PRE_COM_DS IMPORTES,      NMPODSMDS.XXNMP_CAT_PARTIDA_MERC_PC_DS PARTIDA,             NMPODSMDS.XXNMP_CAT_PARTIDA_PREN_DS PREND,      NMPODSMDS.XXNMP_CAT_CLIENTE_PRE_COM_DS CLIENTES,            NMPODSMDS.XXNMP_CAT_DESC_IMP_PRE_COM_DS TOPERACION WHERE 1=1 AND TRUNC(MOVIMIENTO.TIMESTAMP_OPERACION )        between TRUNC(SYSDATE - 120)  and sysdate AND        CLIENTES.CLIENTE_ID = #idCliente AND MOVIMIENTO.ID_PARTIDA_MERCANCIA_DS=PARTIDA.ID_PARTIDA_MERCANCIA_DS        AND PARTIDA.ID_PARTIDA_MERCANCIA_DS=PREND.ID_PARTIDA_MERCANCIA_DS AND PREND.CLIENTE_ID = CLIENTES.CLIENTE_ID        AND MOVIMIENTO.DESC_IMPORTE_ID = TOPERACION.DESC_IMPORTE_ID AND PARTIDA.FECHA_ING_INST > TO_DATE('01/Jan/2012')        AND MOVIMIENTO.DESC_IMPORTE_ID IN (1) AND PARTIDA.MOV_PRENDA_ID NOT IN (2,5,6,7,9,10,49,51,54,59,64,65) AND MOVIMIENTO.ID_DET_MOVIMIENTO_DS=IMPORTES.ID_DET_MOVIMIENTO_DS(+) AND PARTIDA.FOLIO IS NOT NULL group by        MOVIMIENTO.DET_MOVIMIENTO_ID,  MOVIMIENTO.PARTIDA_MERCANCIA_ID,        PARTIDA.FOLIO, TOPERACION.ABREVIATURA, TOPERACION.DESC_IMPORTE,        MOVIMIENTO.NUMERO_SUCURSAL, MOVIMIENTO.TIMESTAMP_OPERACION,        PREND.PRESTAMO, IMPORTES.MEDIO_PAGO_COBRO_ID"/>
      <property name="GetActiveUnitOfWork" value="false"/>
	  <property name="QueryTimeout" value="10"/>
    </interaction-spec>
  </endpoint-interaction>

<endpoint-interaction portType="BITransaccionesPT" operation="GetHistoricoAlmoneda">
    <interaction-spec className="oracle.tip.adapter.db.DBPureSQLInteractionSpec">
      <property name="SqlString" value="SELECT        MOVIMIENTO.PARTIDA_MERCANCIA_ID        , MOVIMIENTO.DET_MOVIMIENTO_ID        , PARTIDA.FOLIO        , TOPERACION.ABREVIATURA        , TOPERACION.DESC_IMPORTE        , MOVIMIENTO.NUMERO_SUCURSAL        , MOVIMIENTO.TIMESTAMP_OPERACION        , PREND.PRESTAMO        , IMPORTES.MEDIO_PAGO_COBRO_ID FROM NMPODSMDS.XXNMP_TX_DET_MOV_PRE_COM_DS MOVIMIENTO,      NMPODSMDS.XXNMP_TX_IMPORTES_PRE_COM_DS IMPORTES,      NMPODSMDS.XXNMP_CAT_PARTIDA_MERC_PC_DS PARTIDA,      NMPODSMDS.XXNMP_CAT_PARTIDA_PREN_DS PREND,      NMPODSMDS.XXNMP_CAT_CLIENTE_PRE_COM_DS CLIENTES,      NMPODSMDS.XXNMP_CAT_DESC_IMP_PRE_COM_DS TOPERACION WHERE 1=1 AND TRUNC(MOVIMIENTO.TIMESTAMP_OPERACION ) between TRUNC(SYSDATE - 45) and sysdate AND CLIENTES.CLIENTE_ID =:idCliente  AND MOVIMIENTO.ID_PARTIDA_MERCANCIA_DS=PARTIDA.ID_PARTIDA_MERCANCIA_DS AND PARTIDA.ID_PARTIDA_MERCANCIA_DS=PREND.ID_PARTIDA_MERCANCIA_DS AND PREND.CLIENTE_ID = CLIENTES.CLIENTE_ID AND MOVIMIENTO.DESC_IMPORTE_ID = TOPERACION.DESC_IMPORTE_ID AND PARTIDA.FECHA_ING_INST > TO_DATE('01/Jan/2012') AND MOVIMIENTO.DESC_IMPORTE_ID IN (32) AND MOVIMIENTO.ID_DET_MOVIMIENTO_DS=IMPORTES.ID_DET_MOVIMIENTO_DS(+) AND PARTIDA.FOLIO IS NOT NULL GROUP BY MOVIMIENTO.DET_MOVIMIENTO_ID        ,  MOVIMIENTO.PARTIDA_MERCANCIA_ID        ,  PARTIDA.FOLIO        ,  TOPERACION.ABREVIATURA        ,  TOPERACION.DESC_IMPORTE        ,  MOVIMIENTO.NUMERO_SUCURSAL        ,  MOVIMIENTO.TIMESTAMP_OPERACION        ,  PREND.PRESTAMO        ,  IMPORTES.MEDIO_PAGO_COBRO_ID"/>
      <property name="GetActiveUnitOfWork" value="false"/>
	  <property name="QueryTimeout" value="10"/>
    </interaction-spec>
  </endpoint-interaction>
</adapter-config>